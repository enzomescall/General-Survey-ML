---
title: "just messin about"
author: "enzo"
date: "2022-12-09"
output: html_document
---

```{r}
library(tidyverse)
library(haven)
library(dplyr)
library(stringr)
library(purrr)

GSS2018 <- read_sav("GSS2018.sav")
```

```{r}
n = ncol(GSS2018)
labels_vector = map_chr(1:n, function(x) attr(GSS2018[[x]], "label"))
variable_name = names(GSS2018)
code_book = data.frame(variable_name, description = labels_vector)

relig_codebook = code_book[grep("happy|relig|strength of affiliation|god|jew|denomination|fundamentalist|bible|muslim|belief|church|pray", labels_vector, ignore.case = TRUE),]

code_book[grep("scientific", labels_vector, ignore.case = TRUE),]

relig_df = GSS2018 %>% 
  select(relig_codebook$variable_name)
```

```{r}
na_num = relig_df %>% # number of NAs per column
  summarise(across(everything(), ~ sum(is.na(.)))) %>%
  pivot_longer(cols = c(1:82)) %>%
  arrange(value) %>%
  filter(value < 0.1*nrow(relig_df))

num_levels = relig_df %>%
  select(na_num$name) %>%
  map(function(x) list(x[1], as.factor(x)[1]))
```

```{r}
relig_small = relig_df %>%
  select(na_num$name) %>%
  view()
```



